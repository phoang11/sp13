<!doctype html>
<html lang="en">
<head>
    <!-- Exercise Manual Viewer Version 1.0.1402.5 -->
    <meta charset="utf-8">
    <title>Exercise Manual Viewer: Hands-On Exercise 7.1</title>
    <link href="jquery-ui-1.10.3.custom.css" rel="stylesheet" />
    <link href="DynEx.css" rel="stylesheet" />
    <script src="jquery-1.9.1.min.js"></script>
    <script src="jquery-ui-1.10.3.custom.min.js"></script>
    <script>
        $(function ()
        {
            $("#accordion0, #accordion1, #accordion2, #accordion3").accordion({
                header: "> div.ExFold",
                collapsible: true,
                active: false,
                heightStyle: "content"
            });

            $("#accordion0, #accordion1, #accordion2, #accordion3").accordion(
                "option",
                "icons",
                { 'header': 'ui-icon-triangle-1-e', 'activeHeader': 'ui-icon-triangle-1-se' });

            $(".copyable code").mouseover(
                function ()
                {
                    var codeElement = $(this);
                    var preElement = codeElement.parent();
                    var codeTag = codeElement[0];
                    var pasteStr = codeTag.textContent ? 
                        codeTag.textContent : codeTag.innerText;
                    var copySite = $("#copysite");
                    copySite.val(pasteStr/*unescapeHTML(pasteStr)*/);
                    copySite.select();
                    preElement.css("background-color", "#f0f0ff");
                    preElement.css("border-color", "#4040ff");
                    preElement.children("div").css("display", "block");
                });

            $(".copyable code").mouseout(
                function()
                {
                    var codeElement = $(this);
                    var preElement = codeElement.parent();
                    preElement.css("background-color", "white");
                    preElement.css("border-color", "white");
                    preElement.children("div").css("display", "none");
                });

            var localStorageOK = hasLocalStorage();
            if (hasLocalStorage)
            {
                $('input:checkbox').click(function () {
                    var $this = $(this);
                    if ($this.is(':checked')) {
                        localStorage.setItem($this.attr("id"), "true");
                    } else {
                        localStorage.setItem($this.attr("id"), "false");
                    }
                });
                $('input:radio').click(function () {
                    var $this = $(this);
                    var groupName = $this.attr('name');
                    $('input:radio[name=' + groupName + ']')
                        .each(function (index, radioItem) {
                            var $radioItem = $(radioItem);
                            if ($radioItem.is(':checked') && localStorageOK) {
                                localStorage.setItem($radioItem.attr("id"), "true");
                            } else {
                                localStorage.setItem($radioItem.attr("id"), "false");
                            }
                        });
                });
                $('input:text, textarea').change(function () {
                    var $this = $(this);
                    var textVal = $this.val();
                    localStorage.setItem($this.attr("id"), textVal);
                });
                $('input:checkbox, input:radio').each(function (index, chkItem) {
                    var $chkItem = $(chkItem);
                    var storedVal = localStorage.getItem($chkItem.attr("id"));
                    $chkItem.prop("checked", storedVal && storedVal == "true");
                });
                $('input:text, textarea').each(function (index, inputItem) {
                    var $inputItem = $(inputItem);
                    var storedVal = localStorage.getItem($inputItem.attr("id"));
                    if (storedVal)
                        $inputItem.val(storedVal);
                });
            }
        });

    function unescapeHTML(str)
    {
        return String(str)
            .replace(/\n/g, '\r\n')
            .replace(/<[^>]*>/g, '')
            .replace(/\&amp;/g, '\&')
            .replace(/\&quot;/g, '\"')
            .replace(/\&#39;/g, '\'')
            .replace(/\&lt;/g, '<')
            .replace(/\&gt;/g, '>')
            .replace(/&nbsp;/g, ' ');
    }

    function escapeHTML(str)
    {
        return String(str)
            .replace(/\n/g, '\r\n')
            .replace(/\&/g, '&amp;')
            .replace(/\"/g, '&quot;')
            .replace(/\'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
    }
    function hasLocalStorage() {
        try {
            return 'localStorage' in window && window['localStorage'] !== null;
        } catch (e) {
            return false;
        }
    }
    </script>
</head>
<body>
<form>
    <div class="ExTitle">
        <div style="width:70%; float:left;">
            <strong>Hands-On Exercise 7.1</strong><br />
            <strong>Reading SQL Server Data From a Workflow</strong>
        </div>
        <div class="ExTitleLink">
            <a href="index.html">Exercise list &hellip;</a>
        </div>
    </div>
    <div class="ExHidden"><textarea style="width:1px; height:1px;" id="copysite"></textarea></div>
    <br /><br />
    <br /><br />
    <br /><br />
    <br /><br />
  <div style="display:table;">
    <div class="ExRow"><div class="ExText"><strong>Objectives</strong></div></div><div class="ExRow"><div class="ExText"><strong><p>HR has requested that we integrate our department's time-off request process with the HR database. Specifically, they would like the workflow to check to make sure employees have the hours they are requesting off before the manager is asked to approve the request.</p><p> </p><p>This update to the process will save time for HR and managers.</p></strong></div></div><div class="ExRow"><div class="ExText"><strong><p>In this exercise, you will</p><ul><li>Create a filtered connection from SharePoint to the HR database table</li><li>Add an external list for the HR hours data</li></ul></strong></div></div><div class="ExRow" style="padding-top:24px;"><div class="ExLeft"><img src="images/exMajorStep.jpg" /></div><div class="ExRight"><strong>Creating a filtered connection from SharePoint to the HR database table</strong></div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        1.
        <input type="checkbox" id="for5jn0" /></div><div class="ExRight" style="vertical-align:baseline;">
        Open your department site in SharePoint Designer if it is not already open.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        2.
        <input type="checkbox" id="for5jn1" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select <b>External Content Types</b> from the Site Objects pane.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 321px;"><img src="images/p3img172.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        3.
        <input type="checkbox" id="for5jn2" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>External Content Type</b> from the ribbon.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 239px;"><img src="images/p3img171.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        4.
        <input type="checkbox" id="for5jn3" /></div><div class="ExRight" style="vertical-align:baseline;">
        <p>Set the following properties in the External Content Type Information section:</p><p> </p><p>Name: <code><strong><em>[Island][Department]</em>HoursAvailable</strong></code></p><p>Display Name: <code><strong>HR Hours Available</strong></code></p><p>Office Item Type: <strong>Generic List</strong></p><p>Offline Sync for external list: <strong>Disabled</strong></p>
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 609px;"><img src="images/p3img170.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        5.
        <input type="checkbox" id="for5jn4" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select the <b>External System</b> link.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 609px;"><img src="images/p3img169.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="RightImages"><img src="images/exInfo.jpg" /></div><div class="ExRight"><i>Data source connections can be reused. The MSC Company Database connection created in a previous exercise will be used for this exercise.</i></div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        6.
        <input type="checkbox" id="for5jn5" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click the <strong>[+]</strong> sign next to <strong><em>[Island] [Department]</em> Database</strong> to expand the data source objects.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 311px;"><img src="images/p3img168.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        7.
        <input type="checkbox" id="for5jn6" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click the <strong>[+]</strong> sign next to the <strong>Tables</strong> data object to expand the tables list.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 258px;"><img src="images/p3img167.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        8.
        <input type="checkbox" id="for5jn7" /></div><div class="ExRight" style="vertical-align:baseline;">
        Right-click the <b>AvailableHours</b> table.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        9.
        <input type="checkbox" id="for5jn8" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select <b>Create All Operations</b> from the menu.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 413px;"><img src="images/p3img166.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        10.
        <input type="checkbox" id="for5jn9" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>Next</b> on the Operation Properties screen.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        11.
        <input type="checkbox" id="for5jn10" /></div><div class="ExRight" style="vertical-align:baseline;">
        Make sure the AccountName field is set as <b>Map to Identifier</b>.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 769px;"><img src="images/p3img165.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        12.
        <input type="checkbox" id="for5jn11" /></div><div class="ExRight" style="vertical-align:baseline;">
        With <b>AccountName</b> selected, select the <b>Show In Picker</b> checkbox.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 335px;"><img src="images/p3img164.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        13.
        <input type="checkbox" id="for5jn12" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select the box for <b>Show In Picker </b>for the remaining fields.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        14.
        <input type="checkbox" id="for5jn13" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>Next</b>.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        15.
        <input type="checkbox" id="for5jn14" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>Add Filter Parameter</b> to add a new filter on the Filter Parameters Configuration page.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 213px;"><img src="images/p3img163.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        16.
        <input type="checkbox" id="for5jn15" /></div><div class="ExRight" style="vertical-align:baseline;">
        Verify that the Data Source Element is set to <b>AccountName</b>.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 323px;"><img src="images/p3img162.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        17.
        <input type="checkbox" id="for5jn16" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select the <strong>(Click to Add)</strong> link in the Properties pane to edit the filter criteria.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 367px;"><img src="images/p3img161.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        18.
        <input type="checkbox" id="for5jn17" /></div><div class="ExRight" style="vertical-align:baseline;">
        Rename the filter <code><b>DeptFilter</b></code>
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 594px;"><img src="images/p3img160.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        19.
        <input type="checkbox" id="for5jn18" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>OK</b>.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        20.
        <input type="checkbox" id="for5jn19" /></div><div class="ExRight" style="vertical-align:baseline;">
        Set the Default Value to your <code><strong><em>[Island]</em>.<em>[Department</em></strong></code><em>]</em>. <em>Don't</em> press <code>&lt;Enter&gt;</code>.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 363px;"><img src="images/p3img159.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        21.
        <input type="checkbox" id="for5jn20" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>Finish</b>.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        22.
        <input type="checkbox" id="for5jn21" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>Summary View</b> in the ribbon.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 246px;"><img src="images/p3img158.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        23.
        <input type="checkbox" id="for5jn22" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select <b>AccountName</b> from the Fields section.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 608px;"><img src="images/p3img157.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        24.
        <input type="checkbox" id="for5jn23" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>Set as Title</b> in the ribbon.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 123px;"><img src="images/p3img156.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        25.
        <input type="checkbox" id="for5jn24" /></div><div class="ExRight" style="vertical-align:baseline;">
        Save your work.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 786px;"><img src="images/p3img155.png" /></div>
      </div></div><div class="ExRow" style="padding-top:24px;"><div class="ExLeft"><img src="images/exMajorStep.jpg" /></div><div class="ExRight"><strong>Adding an external list for the HR hours data</strong></div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        26.
        <input type="checkbox" id="for5jn25" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select <b>Lists and Libraries</b> from the Site Objects pane.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 285px;"><img src="images/p3img154.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        27.
        <input type="checkbox" id="for5jn26" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>External List</b> from the New group of the ribbon.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 228px;"><img src="images/p3img153.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        28.
        <input type="checkbox" id="for5jn27" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select the <strong><em>[Island][Department]</em>HoursAvailable</strong> external content type from the External Content Type Picker dialog. It's the second one in the screenshot below.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 527px;"><img src="images/p3img152.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        29.
        <input type="checkbox" id="for5jn28" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>OK</b>.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        30.
        <input type="checkbox" id="for5jn29" /></div><div class="ExRight" style="vertical-align:baseline;">
        <p>In the Create External List dialog, set the following values:</p><p> </p><p>Name: <code><strong>Available Hours</strong></code></p><p>Description: <code><strong>Department hours available from the HR database</strong></code></p>
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 663px;"><img src="images/p3img151.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        31.
        <input type="checkbox" id="for5jn30" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>OK</b>.
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        32.
        <input type="checkbox" id="for5jn31" /></div><div class="ExRight" style="vertical-align:baseline;">
        Select <b>Available Hours</b> in the External Lists section.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 455px;"><img src="images/p3img150.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        33.
        <input type="checkbox" id="for5jn32" /></div><div class="ExRight" style="vertical-align:baseline;">
        Click <b>Preview in Browser</b> in the ribbon to check your work.
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 150px;"><img src="images/p3img149.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="RightImages"><img src="images/exInfo.jpg" /></div><div class="ExRight"><i>You should see one row with your department's available hours.</i></div></div><div class="ExRow"><div class="ExLeft"><img src="images/exPadding.jpg" /></div><div class="ExRight">
        <div class="MediaDiv" style="max-width: 579px;"><img src="images/p3img148.png" /></div>
      </div></div><div class="ExRow"><div class="ExLeft" style="vertical-align:baseline;">
        34.
        <input type="checkbox" id="for5jn33" /></div><div class="ExRight" style="vertical-align:baseline;">
        Close Internet Explorer and return to SharePoint Designer.
      </div></div><div class="ExRow" style="padding-top:24px;"><div class="ExLeft"><img src="images/exFinish.jpg" /></div><div class="ExRight"><strong>Congratulations! You have created a filtered connection to the MSC HR data in SQL Server.</strong></div></div><div class="ExRow"><div class="ExCentredText"><img src="images/ExStop.jpg" /><br /><strong><i>This is the end of the exercise.</i></strong></div></div>
  </div>
  <div class="ExFooter"><br/>Viewer version 1.0.1505.28</div>
</form>
</body>
</html>


